HEALTH_READMISSIONS

create database hospital;
use hospital;

CREATE TABLE hospital_readmissions (
    age VARCHAR(20),
    time_in_hospital INT,
    n_procedures INT,
    n_lab_procedures INT,
    n_medications INT,
    n_outpatient INT,
    n_inpatient INT,
    n_emergency INT,
    medical_specialty VARCHAR(100),
    diag_1 VARCHAR(100),
    diag_2 VARCHAR(100),
    diag_3 VARCHAR(100),
    glucose_test VARCHAR(20),
    A1Ctest VARCHAR(20),
    changes VARCHAR(10),
    diabetes_med VARCHAR(10),
    readmitted VARCHAR(10)
);

SET GLOBAL local_infile = 1;

LOAD DATA INFILE 'C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/hospital_readmissions.csv'
INTO TABLE hospital_readmissions
FIELDS TERMINATED BY ',' 
OPTIONALLY ENCLOSED BY '"' 
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

KPI 1:  Average Length of Stay by Age Group
Q: What is the average hospital stay duration for different age groups?
Why:
Longer stays increase costs and risk of complications. Understanding which age groups stay longer helps hospitals optimize care and allocate resources effectively. 

We are using avg instead of sum because we are trying to find how many days an individual stayed in that particular group...sum would just give the total days the beds were occupied in the hospital like sum(everyone in that age group) and not individual.
The average shows 4.8 days like decimals so while explaining: 

On average, patients in that group stay about 4 days and a bit more — nearly 5 days.
It’s a statistical average, summarizing the overall patient stays in that group.
No patient actually stays 4.8 days exactly, but many stay 4 or 5 days, and the average is the “middle ground.”
This helps hospitals estimate typical resource use (beds, staff time) for that patient group.
Basically, it means typical hospital stay is just under 5 days for that age bracket.

Insight:
Patients aged 70 and above have the longest average hospital stay of 5 days, while those between 40 and 70 stay around 4 days.
Conclusion:
Hospitals should prioritize resources for older patients, as they tend to require longer care and more hospital days.


KPI 2: Readmission Rate by Age Group
What it solves:
Measures how many patients get readmitted to the hospital after discharge. High readmission rates may indicate poor care quality, ineffective treatment, or premature discharge.
Why it’s useful:
Helps hospitals identify patient groups at risk of readmission.
Enables targeted interventions to reduce readmissions, improving patient outcomes and reducing costs.

SELECT 
    readmitted,
    LENGTH(readmitted) AS len,
    HEX(readmitted) AS hex_val,
    COUNT(*) 
FROM hospital_readmissions 
GROUP BY readmitted;
=== no   3	6E6F0D	13246
       yes	4	7965730D	11754

From the hex codes:
no ends with 0D (which is a carriage return \r)
yes also ends with 0D
So your readmitted values have a trailing carriage return character (\r), causing the equality check readmitted = 'yes' to fail.

Insight:
The readmission rate varies by age group, with the highest rate (49.58%) observed in patients aged 80-90, followed closely by the 70-80 age group at 48.79%. Younger groups such as 40-50 and 50-60 have lower readmission rates around 44%, while the oldest group (90-100) shows a slightly lower rate at 42.13%.
Conclusion:
Older patients, especially those between 70 and 90 years, are more likely to be readmitted to the hospital. This suggests that healthcare providers should prioritize post-discharge care and monitoring for elderly patients to reduce readmissions and improve their health outcomes.

KPI 3: READMISSION RATE BY MEDICAL SPECIALITY
What are we solving?
We want to find which medical specialties have higher patient readmission rates, indicating potential challenges in treatment effectiveness or post-discharge care.

Why is it useful?
Helps hospitals identify areas needing better patient follow-up or care quality improvement.
Can reduce unnecessary readmissions, lowering costs and improving patient outcomes.
Supports targeted interventions for specialties with high readmission rates.

Insight:
The highest readmission rates are seen in Family/General Practice (49.5%) and Emergency/Trauma (49.4%), followed closely by Cardiology (45%) and Internal Medicine (44.8%). These specialties have almost half of their patients returning to the hospital after discharge.
Conclusion:
High readmission rates in Family Practice and Emergency suggest that these departments may need better follow-up care, patient education, or discharge planning to reduce repeat visits. Improving care coordination in these areas can help reduce hospital costs and improve patient health outcomes.

KPI 4: Average Number of Medications Administered per Patient
What are we solving?
Understanding the average medication load per patient helps hospitals monitor potential polypharmacy risks, manage pharmacy inventory, and tailor patient care to avoid medication errors or adverse effects.
Why is it useful?
Identifies if certain patient groups are getting excessive medications.
Helps improve patient safety and optimize medication management.
Aids in resource planning for pharmacy and clinical staff.

Insight:
On average, each patient in the dataset was administered about 16 medications during their hospital stay.
Conclusion:
This relatively high average medication count suggests that patients might be dealing with complex or multiple health conditions requiring several drugs. Hospitals should monitor such cases closely to manage the risks of polypharmacy, including potential drug interactions and side effects. This insight can help improve patient safety protocols and optimize pharmacy inventory management.

KPI 5: DISTRIBUTION OF PRIMARY DIAGNOSIS CATEGORIES (diag_1) BY PATIENT COUNT
What are we solving?
Identifying the most common primary diagnoses helps hospitals understand which health conditions lead to the most admissions, enabling better resource allocation, specialized care, and preventive programs.

Why is it useful?
Helps hospital management prioritize staffing and equipment for prevalent conditions.
Supports targeted health interventions and community health programs.
Enables better budgeting and training for specialty departments.

Insight:
Most patients were admitted because of heart-related problems (7,824 cases). Other common reasons include different health issues grouped as “Other” (6,498 cases) and lung-related problems (3,680 cases). There are also quite a few patients with digestive, diabetes, injury, and muscle or bone issues.
Conclusion:
Since heart problems are the main reason for hospital stays, the hospital should focus on heart care services and prevention programs. They should also make sure they have enough staff and equipment for lung and digestive issues. This helps the hospital plan better and provide the right care to the patients who need it most.

KPI 6: AVERAGE NUMBER OF PROCEDURES BY MEDICAL SPECIALITY
What are we solving?
Understanding how many procedures are performed on average per patient by each medical specialty helps hospitals assess workload, plan resource allocation, and identify high-demand specialties.

Why is it useful?
Helps with staffing and equipment planning for different departments.
Reveals which specialties handle more complex or procedure-heavy cases.
Aids in improving operational efficiency.

Insight:
Patients admitted under Internal Medicine had the highest average number of procedures (50), followed by Emergency/Trauma (43.6) and Family/General Practice (43.1). Many records have missing specialty data, but among known specialties, Cardiology and Surgery also perform a high number of procedures.
Conclusion:
Internal Medicine and Emergency departments handle the most complex or procedure-heavy cases, indicating high workload and resource needs in these areas. Hospitals should ensure adequate staffing, equipment, and training in these specialties to maintain quality care and efficiency.



KPI 7: AVERAGE NUMBER OF EMERGENCY VISITS IN PAST YEAR BY AGE GROUP
What are we measuring?
We are calculating the average number of emergency room visits (n_emergency) made by patients in the year prior to their hospital admission, grouped by age bracket.

Why is this important for hospitals?
This helps identify which age groups tend to rely more on emergency care before being admitted.
Hospitals can use this insight to design preventive care strategies for high-risk groups to reduce emergency visits.
It also assists in resource allocation for emergency departments based on demand trends among different age groups.

Insight:
Patients in the 40–50 age group had the highest average emergency visits (0.40), followed by 50–60 (0.23) and 60–70 (0.16).
Surprisingly, older age groups (70–100) had fewer average emergency visits, with averages as low as 0.14–0.15.

Conclusion:
Middle-aged patients (particularly 40–60 years) are more likely to use emergency services before hospitalization.
This could indicate that younger adults delay care and only seek help during emergencies, or they may face more acute conditions requiring emergency attention.
Hospitals can target preventive care, health education, and chronic disease management more intensively for the 40–60 age group to reduce avoidable emergency room visits and improve early intervention.

KPI 8: EFFECT OF DIABETES MEDICATION CHANGE ON READMISSION RATES
What we’re analyzing:
We want to understand whether changing diabetes medications affects patient readmission rates. This insight helps hospitals evaluate treatment effectiveness and decide if certain changes are helping reduce return visits.

Why this KPI is important:
Frequent readmissions can indicate poor diabetes management.
If medication changes reduce readmissions, it signals improved patient outcomes.
Hospitals can create better discharge plans and medication review protocols.

Insight:
Patients who had a change in their diabetes medication (yes) had a readmission rate of 49.35%.
Patients with no change in medication (no) had a readmission rate of 47.77%.

Conclusion:
Changing diabetes medication is associated with a slightly higher readmission rate.
This could indicate:
Patients requiring medication changes might have more severe or unstable diabetes.
It may take time for new medications to stabilize the patient’s condition, leading to higher readmission risk shortly after change.

Use for Hospital Decision-Making:
Monitor patients closely after changing medications.
Strengthen post-discharge follow-ups for patients undergoing diabetes treatment adjustments.
Helps prioritize care plans for higher-risk diabetic patients.

KPI 9: A1C TEST RESULT VS READMISSION RATE
Why it matters to hospitals:
The A1C test shows how well a patient's blood sugar has been controlled over the past few months.
High A1C means poor diabetes control, which can cause complications leading to hospital readmission.
By measuring readmission rates across A1C results, hospitals can identify if patients with poorly controlled diabetes are more likely to come back.
This helps hospitals:
Focus care and education on patients with high A1C to reduce readmissions.
Improve diabetes management programs, potentially lowering costs and improving patient health.
Allocate resources for better follow-up and support for high-risk patients.

Insight:
Patients with no A1C test performed have the highest readmission rate (47.45%), followed by those with a high A1C result (45.95%), while patients with a normal A1C level have the lowest readmission rate (42.11%).

Conclusion:
Regular A1C testing and maintaining normal blood sugar levels are associated with lower hospital readmission rates. Hospitals should encourage consistent A1C monitoring and better diabetes management to reduce readmissions and improve patient outcomes.

KPI 10: AVERAGE NUMBER OF OUTPATIENT VISITS BY READMISSION STATUS
What: Calculate the average number of outpatient visits (n_outpatient) in the year before hospital stay for patients who were readmitted vs those who were not.

Why is this KPI useful for hospitals?
Hospitals want to reduce patient readmissions because readmissions often mean complications or ineffective care, which increase costs and strain resources.
By analyzing the average outpatient visits before readmission, hospitals can see if patients who regularly visit outpatient clinics are less likely to be readmitted.
If patients with more outpatient visits have fewer readmissions, hospitals can encourage better outpatient follow-up care to prevent costly readmissions.
Conversely, if patients with many outpatient visits still get readmitted often, it might mean outpatient care needs improvement.
This helps hospitals plan resources, improve patient care, and reduce avoidable readmissions, saving money and improving patient outcomes.

Insight:
Patients who were readmitted had almost double the average number of inpatient visits in the past year (0.49) compared to those who were not readmitted (0.26).

Conclusion:
A higher number of prior inpatient visits is associated with increased readmission risk. This suggests that patients with frequent hospital stays may have more complex or chronic health issues requiring closer monitoring and targeted care to reduce readmission rates. Hospitals can use this insight to identify high-risk patients early and provide enhanced care management or follow-up to prevent avoidable readmissions.






